{
  "_metadata": {
    "file_version": "v3.1-3d-10.11-1",
    "last_modified": "2025-08-14",
    "clean_architecture": "v3.1 Compliant",
    "configuration_version": "3d.10.10",
    "description": "AI model ensemble configuration for NLP crisis detection system",
    "created_date": "2025-08-12",
    "updated_date": "2025-08-14",
    "compliance": "Clean Architecture v3.1 Standards",
    "managers": ["ModelEnsembleManager", "ModelsManager"],
    "cleanup_note": "Step 10.10 - Mapped model weights to existing .env.template variables, preserved others for .env.template addition"
  },

  "model_ensemble": {
    "model_definitions": {
      "depression": {
        "name": "${NLP_MODEL_DEPRESSION_NAME}",
        "weight": "${NLP_ANALYSIS_ENSEMBLE_WEIGHT_DEPRESSION}",
        "type": "${NLP_MODEL_DEPRESSION_TYPE}",
        "pipeline_task": "${NLP_MODEL_DEPRESSION_PIPELINE_TASK}",
        "cache_dir": "${NLP_STORAGE_MODELS_DIR}",
        "enabled": "${NLP_MODEL_DEPRESSION_ENABLED}"
      },
      "sentiment": {
        "name": "${NLP_MODEL_SENTIMENT_NAME}",
        "weight": "${NLP_ANALYSIS_ENSEMBLE_WEIGHT_SENTIMENT}",
        "type": "${NLP_MODEL_SENTIMENT_TYPE}",
        "pipeline_task": "${NLP_MODEL_SENTIMENT_PIPELINE_TASK}",
        "cache_dir": "${NLP_STORAGE_MODELS_DIR}",
        "enabled": "${NLP_MODEL_SENTIMENT_ENABLED}"
      },
      "emotional_distress": {
        "name": "${NLP_MODEL_DISTRESS_NAME}",
        "weight": "${NLP_ANALYSIS_ENSEMBLE_WEIGHT_DISTRESS}",
        "type": "${NLP_MODEL_DISTRESS_TYPE}",
        "pipeline_task": "${NLP_MODEL_DISTRESS_PIPELINE_TASK}",
        "cache_dir": "${NLP_STORAGE_MODELS_DIR}",
        "enabled": "${NLP_MODEL_DISTRESS_ENABLED}"
      }
    },
    "ensemble_config": {
      "mode": "${NLP_ENSEMBLE_MODE}",
      "require_all_models": "${NLP_MODEL_ENSEMBLE_REQUIRE_ALL_MODELS}",
      "fallback_mode": "${NLP_MODEL_ENSEMBLE_FALLBACK_MODE}",
      "confidence_threshold": "${NLP_MODEL_ENSEMBLE_CONFIDENCE_THRESHOLD}"
    }
  },

  "hardware_settings": {
    "device": "${NLP_HARDWARE_DEVICE}",
    "device_map": "${NLP_HARDWARE_DEVICE_MAP}",
    "load_in_8bit": "${NLP_HARDWARE_LOAD_IN_8BIT}",
    "load_in_4bit": "${NLP_HARDWARE_LOAD_IN_4BIT}",
    "torch_dtype": "${NLP_HARDWARE_TORCH_DTYPE}",
    "max_memory": "${NLP_HARDWARE_MAX_MEMORY}",
    "offload_folder": "${NLP_HARDWARE_OFFLOAD_FOLDER}"
  },

  "defaults": {
    "model_definitions": {
      "depression": {
        "name": "j-hartmann/emotion-english-distilroberta-base",
        "weight": 0.4,
        "type": "text-classification",
        "pipeline_task": "text-classification",
        "cache_dir": "./models/cache",
        "enabled": true
      },
      "sentiment": {
        "name": "cardiffnlp/twitter-roberta-base-sentiment-latest",
        "weight": 0.3,
        "type": "text-classification",
        "pipeline_task": "text-classification",
        "cache_dir": "./models/cache",
        "enabled": true
      },
      "emotional_distress": {
        "name": "SamLowe/roberta-base-go_emotions",
        "weight": 0.3,
        "type": "text-classification",
        "pipeline_task": "text-classification",
        "cache_dir": "./models/cache",
        "enabled": true
      }
    },
    "ensemble_config": {
      "mode": "consensus",
      "require_all_models": false,
      "fallback_mode": "majority",
      "confidence_threshold": 0.7
    },
    "hardware_settings": {
      "device": "auto",
      "device_map": "auto",
      "load_in_8bit": false,
      "load_in_4bit": false,
      "torch_dtype": "float16",
      "max_memory": null,
      "offload_folder": null
    }
  },

  "validation": {
    "description": "Model ensemble validation rules and constraints",
    "model_definitions": {
      "name": {
        "type": "string",
        "required": true,
        "min_length": 5,
        "description": "HuggingFace model name"
      },
      "weight": {
        "type": "float",
        "range": [0.0, 1.0],
        "description": "Model weight in ensemble (should sum to 1.0 across all models)"
      },
      "type": {
        "type": "string",
        "allowed_values": ["text-classification", "sequence-classification"],
        "description": "Model type classification"
      },
      "pipeline_task": {
        "type": "string",
        "allowed_values": ["text-classification", "sentiment-analysis"],
        "description": "HuggingFace pipeline task"
      },
      "cache_dir": {
        "type": "string",
        "description": "Model cache directory path"
      },
      "enabled": {
        "type": "boolean",
        "description": "Whether model is enabled for ensemble"
      }
    },
    "ensemble_config": {
      "mode": {
        "type": "string",
        "allowed_values": ["consensus", "majority", "weighted"],
        "description": "Ensemble decision mode"
      },
      "require_all_models": {
        "type": "boolean",
        "description": "Whether all models must be loaded for analysis"
      },
      "fallback_mode": {
        "type": "string",
        "allowed_values": ["consensus", "majority", "weighted"],
        "description": "Fallback mode if primary mode fails"
      },
      "confidence_threshold": {
        "type": "float",
        "range": [0.0, 1.0],
        "description": "Minimum confidence for ensemble decisions"
      }
    },
    "hardware_settings": {
      "device": {
        "type": "string",
        "allowed_values": ["auto", "cpu", "cuda", "mps"],
        "description": "Hardware device for model inference"
      },
      "device_map": {
        "type": "string",
        "description": "Device mapping strategy"
      },
      "load_in_8bit": {
        "type": "boolean",
        "description": "Load models in 8-bit precision"
      },
      "load_in_4bit": {
        "type": "boolean",
        "description": "Load models in 4-bit precision"
      },
      "torch_dtype": {
        "type": "string",
        "allowed_values": ["float16", "float32", "bfloat16"],
        "description": "Torch data type for model weights"
      }
    }
  }
}