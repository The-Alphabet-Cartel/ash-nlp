# ash-nlp/.env.template - PHASE 3C CLEAN MIGRATION
# =============================================================================
# Ash-NLP Crisis Detection System - Environment Configuration
# Phase 3c: Mode-Aware Threshold Configuration - Clean Migration
# 
# Repository: https://github.com/the-alphabet-cartel/ash-nlp (v3.1 branch)
# Community: The Alphabet Cartel - https://discord.gg/alphabetcartel
# =============================================================================
# =============================================================================
# HUGGING FACE CONFIGURATION
# =============================================================================
GLOBAL_HUGGINGFACE_TOKEN=/run/secrets/huggingface
NLP_HUGGINGFACE_CACHE_DIR=./models/cache

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================
NLP_HOST=0.0.0.0
GLOBAL_NLP_API_PORT=8881
NLP_UVICORN_WORKERS=1
NLP_RELOAD_ON_CHANGES=false

# =============================================================================
# SECURITY
# =============================================================================
GLOBAL_ALLOWED_IPS=10.20.30.0/24,127.0.0.1,::1
GLOBAL_ENABLE_CORS=true

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
GLOBAL_LOG_LEVEL=INFO
NLP_LOG_FILE=nlp_service.log
NLP_ENABLE_DETAILED_LOGGING=true
NLP_INCLUDE_RAW_LABELS=true
NLP_LOG_THRESHOLD_CHANGES=true
NLP_LOG_MODEL_DISAGREEMENTS=true
NLP_LOG_STAFF_REVIEW_TRIGGERS=true
NLP_LOG_PATTERN_ADJUSTMENTS=true
NLP_LOG_LEARNING_UPDATES=true
NLP_LOG_LABEL_MAPPINGS=true

# =============================================================================
# STORAGE PATHS
# =============================================================================
NLP_DATA_DIR=./data
NLP_MODELS_DIR=./models/cache
NLP_LOGS_DIR=./logs
NLP_LEARNING_DATA_DIR=./learning_data

# =============================================================================
# HARDWARE OPTIMIZATION
# =============================================================================
NLP_DEVICE=cuda
NLP_MODEL_PRECISION=float16
NLP_MAX_BATCH_SIZE=32
NLP_INFERENCE_THREADS=16
NLP_CONCURRENT_REQUESTS=20
NLP_REQUEST_TIMEOUT=40
NLP_MAX_LENGTH=512
NLP_NUM_WORKERS=4

# =============================================================================
# MODEL MANAGER SETTINGS
# =============================================================================
# Three-Model Configuration
NLP_DEPRESSION_MODEL=MoritzLaurer/deberta-v3-base-zeroshot-v2.0
NLP_SENTIMENT_MODEL=MoritzLaurer/mDeBERTa-v3-base-mnli-xnli
NLP_EMOTIONAL_DISTRESS_MODEL=Lowerated/lm6-deberta-v3-topic-sentiment
NLP_MODEL_CACHE_DIR=./models/cache

# Additional Model Manager Settings
NLP_MODEL_USE_FAST_TOKENIZER=true
NLP_MODEL_TRUST_REMOTE_CODE=false  
NLP_MODEL_REVISION=main

# =============================================================================
# ENSEMBLE CONFIGURATION - Core System
# =============================================================================
# Ensemble mode selection (consensus/majority/weighted)
NLP_ENSEMBLE_MODE=weighted

# Gap detection for model disagreement
NLP_ENABLE_GAP_DETECTION=true
NLP_GAP_DETECTION_THRESHOLD=0.25
NLP_GAP_DISAGREEMENT_THRESHOLD=0.30

# Model weights for weighted ensemble mode
NLP_MODEL_WEIGHT_DEPRESSION=0.75
NLP_MODEL_WEIGHT_SENTIMENT=0.10  
NLP_MODEL_WEIGHT_EMOTIONAL_DISTRESS=0.15

# =============================================================================
# Phase 2 - ZERO-SHOT LABELS CONFIGURATION
# =============================================================================
# Choose which label set to use for zero-shot classification
# Options: enhanced_crisis, clinical_focused, conversational, safety_first
NLP_ZERO_SHOT_LABEL_SET=enhanced_crisis
NLP_ZERO_SHOT_ENABLE_LABEL_SET_SWITCHING=true
NLP_ZERO_SHOT_TRACK_LABEL_PERFORMANCE=true

# =============================================================================
# PHASE 3A - CRISIS PATTERN CONFIGURATION
# =============================================================================
NLP_CONFIG_ENABLE_CRISIS_PATTERNS=true
NLP_CONFIG_ENABLE_LGBTQIA_PATTERNS=true
NLP_CONFIG_ENABLE_POSITIVE_CONTEXTS=true
NLP_CONFIG_CRISIS_CONTEXT_BOOST_MULTIPLIER=1.0
NLP_CONFIG_LGBTQIA_WEIGHT_MULTIPLIER=1.0
NLP_CONFIG_BURDEN_WEIGHT_MULTIPLIER=1.2
NLP_CONFIG_ENHANCED_CRISIS_WEIGHT=1.2

# =============================================================================
# PHASE 3B - ANALYSIS PARAMETERS CONFIGURATION
# =============================================================================
# ============== CRISIS THRESHOLDS ==========================================
# Core crisis level mapping thresholds for analysis algorithms
NLP_ANALYSIS_CRISIS_THRESHOLD_HIGH=0.55
NLP_ANALYSIS_CRISIS_THRESHOLD_MEDIUM=0.28
NLP_ANALYSIS_CRISIS_THRESHOLD_LOW=0.16

# ============== PHRASE EXTRACTION PARAMETERS ===============================
NLP_ANALYSIS_MIN_PHRASE_LENGTH=2
NLP_ANALYSIS_MAX_PHRASE_LENGTH=6
NLP_ANALYSIS_PHRASE_CRISIS_FOCUS=true
NLP_ANALYSIS_PHRASE_COMMUNITY_SPECIFIC=true
NLP_ANALYSIS_PHRASE_MIN_CONFIDENCE=0.3
NLP_ANALYSIS_PHRASE_MAX_RESULTS=20

# ============== PATTERN LEARNING PARAMETERS ================================
NLP_ANALYSIS_PATTERN_MIN_CRISIS_MESSAGES=10
NLP_ANALYSIS_PATTERN_MAX_PHRASES_TO_ANALYZE=200
NLP_ANALYSIS_PATTERN_MIN_DISTINCTIVE_SCORE=0.7
NLP_ANALYSIS_PATTERN_LEARNING_CONFIDENCE_THRESHOLD=0.8
NLP_ANALYSIS_PATTERN_LEARNING_SIGNIFICANCE_THRESHOLD=0.05

# ============== SEMANTIC ANALYSIS PARAMETERS ===============================
NLP_ANALYSIS_CONTEXT_WINDOW_SIZE=3
NLP_ANALYSIS_SEMANTIC_SIMILARITY_THRESHOLD=0.75
NLP_ANALYSIS_CONTEXT_BOOST_WEIGHT=1.5
NLP_ANALYSIS_SEMANTIC_NEGATIVE_THRESHOLD=0.6

# ============== ADVANCED PARAMETERS =======================================
NLP_ANALYSIS_CONFIDENCE_BOOST_HIGH=0.15
NLP_ANALYSIS_CONFIDENCE_BOOST_MEDIUM=0.10
NLP_ANALYSIS_CONFIDENCE_BOOST_LOW=0.05
NLP_ANALYSIS_PATTERN_WEIGHT_MULTIPLIER=1.2
NLP_ANALYSIS_ENSEMBLE_WEIGHT_DEPRESSION=0.4
NLP_ANALYSIS_ENSEMBLE_WEIGHT_SENTIMENT=0.3
NLP_ANALYSIS_ENSEMBLE_WEIGHT_DISTRESS=0.3

# ============== INTEGRATION SETTINGS ======================================
NLP_ANALYSIS_ENABLE_PATTERN_ANALYSIS=true
NLP_ANALYSIS_ENABLE_SEMANTIC_ANALYSIS=true
NLP_ANALYSIS_ENABLE_PHRASE_EXTRACTION=true
NLP_ANALYSIS_ENABLE_PATTERN_LEARNING=true
NLP_ANALYSIS_INTEGRATION_MODE=full

# ============== PERFORMANCE SETTINGS ======================================
NLP_ANALYSIS_TIMEOUT_MS=5000
NLP_ANALYSIS_MAX_CONCURRENT=10
NLP_ANALYSIS_ENABLE_CACHING=true
NLP_ANALYSIS_CACHE_TTL_SECONDS=300
NLP_ANALYSIS_ENABLE_PARALLEL_PROCESSING=true

# ============== DEBUGGING SETTINGS ========================================
NLP_ANALYSIS_ENABLE_DETAILED_LOGGING=true
NLP_ANALYSIS_LOG_ANALYSIS_STEPS=false
NLP_ANALYSIS_INCLUDE_REASONING=true
NLP_ANALYSIS_ENABLE_PERFORMANCE_METRICS=true

# ============== EXPERIMENTAL FEATURES =====================================
NLP_ANALYSIS_EXPERIMENTAL_ADVANCED_CONTEXT=false
NLP_ANALYSIS_EXPERIMENTAL_COMMUNITY_VOCAB=true
NLP_ANALYSIS_EXPERIMENTAL_TEMPORAL_PATTERNS=true
NLP_ANALYSIS_EXPERIMENTAL_MULTI_LANGUAGE=false

# =============================================================================
# PHASE 3C - MODE-AWARE THRESHOLD MAPPING CONFIGURATION
# =============================================================================
# ============== CONSENSUS MODE THRESHOLDS ==================================
# Conservative thresholds for consensus mode - requires model agreement
NLP_THRESHOLD_CONSENSUS_CRISIS_TO_HIGH=0.50
NLP_THRESHOLD_CONSENSUS_CRISIS_TO_MEDIUM=0.30
NLP_THRESHOLD_CONSENSUS_MILD_CRISIS_TO_LOW=0.40
NLP_THRESHOLD_CONSENSUS_NEGATIVE_TO_LOW=0.70
NLP_THRESHOLD_CONSENSUS_UNKNOWN_TO_LOW=0.50

# Consensus ensemble thresholds
NLP_THRESHOLD_CONSENSUS_ENSEMBLE_HIGH=0.45
NLP_THRESHOLD_CONSENSUS_ENSEMBLE_MEDIUM=0.25
NLP_THRESHOLD_CONSENSUS_ENSEMBLE_LOW=0.12

# ============== MAJORITY MODE THRESHOLDS ===================================
# Balanced thresholds for majority vote - democratic decision making
NLP_THRESHOLD_MAJORITY_CRISIS_TO_HIGH=0.45
NLP_THRESHOLD_MAJORITY_CRISIS_TO_MEDIUM=0.28
NLP_THRESHOLD_MAJORITY_MILD_CRISIS_TO_LOW=0.35
NLP_THRESHOLD_MAJORITY_NEGATIVE_TO_LOW=0.65
NLP_THRESHOLD_MAJORITY_UNKNOWN_TO_LOW=0.45

# Majority ensemble thresholds
NLP_THRESHOLD_MAJORITY_ENSEMBLE_HIGH=0.42
NLP_THRESHOLD_MAJORITY_ENSEMBLE_MEDIUM=0.23
NLP_THRESHOLD_MAJORITY_ENSEMBLE_LOW=0.11

# ============== WEIGHTED MODE THRESHOLDS ===================================
# Higher thresholds for weighted mode - accounts for depression model dominance
NLP_THRESHOLD_WEIGHTED_CRISIS_TO_HIGH=0.55
NLP_THRESHOLD_WEIGHTED_CRISIS_TO_MEDIUM=0.32
NLP_THRESHOLD_WEIGHTED_MILD_CRISIS_TO_LOW=0.42
NLP_THRESHOLD_WEIGHTED_NEGATIVE_TO_LOW=0.72
NLP_THRESHOLD_WEIGHTED_UNKNOWN_TO_LOW=0.52

# Weighted ensemble thresholds
NLP_THRESHOLD_WEIGHTED_ENSEMBLE_HIGH=0.48
NLP_THRESHOLD_WEIGHTED_ENSEMBLE_MEDIUM=0.27
NLP_THRESHOLD_WEIGHTED_ENSEMBLE_LOW=0.13

# ============== STAFF REVIEW CONFIGURATION =================================
# Determines when cases require human staff review
NLP_THRESHOLD_STAFF_REVIEW_HIGH_ALWAYS=true
NLP_THRESHOLD_STAFF_REVIEW_MEDIUM_CONFIDENCE=0.45
NLP_THRESHOLD_STAFF_REVIEW_LOW_CONFIDENCE=0.75
NLP_THRESHOLD_STAFF_REVIEW_ON_DISAGREEMENT=true
NLP_THRESHOLD_STAFF_REVIEW_GAP_DETECTION=true
NLP_THRESHOLD_STAFF_REVIEW_PATTERN_MISMATCH=true

# ============== LEARNING SYSTEM CONFIGURATION =============================
# Learning system threshold adjustment parameters
NLP_THRESHOLD_LEARNING_FEEDBACK_WEIGHT=0.1
NLP_THRESHOLD_LEARNING_MIN_SAMPLES=5
NLP_THRESHOLD_LEARNING_ADJUSTMENT_LIMIT=0.05
NLP_THRESHOLD_LEARNING_ENABLED=true
NLP_THRESHOLD_LEARNING_RATE=0.01
NLP_THRESHOLD_LEARNING_MAX_DRIFT=0.1
NLP_THRESHOLD_LEARNING_MAX_ADJUSTMENTS_PER_DAY=50
NLP_THRESHOLD_LEARNING_PERSISTENCE_FILE=./learning_data/adjustments.json
NLP_THRESHOLD_LEARNING_MIN_CONFIDENCE_ADJUSTMENT=0.05
NLP_THRESHOLD_LEARNING_MAX_CONFIDENCE_ADJUSTMENT=0.30

# ============== SAFETY CONTROLS ============================================
# Safety mechanisms and bias controls
NLP_THRESHOLD_SAFETY_BIAS=0.03
NLP_THRESHOLD_ENABLE_SAFETY_OVERRIDE=true
NLP_THRESHOLD_MINIMUM_RESPONSE=0.10
NLP_THRESHOLD_FAIL_SAFE_ESCALATION=true
NLP_THRESHOLD_MAX_CONFIDENCE_CAP=0.95
NLP_THRESHOLD_MIN_CONFIDENCE_FLOOR=0.05

# ============== PATTERN INTEGRATION CONTROLS ==============================
# Controls how crisis patterns adjust ensemble results
NLP_THRESHOLD_PATTERN_WEIGHT_MULTIPLIER=1.2
NLP_THRESHOLD_PATTERN_BOOST_LIMIT=0.15
NLP_THRESHOLD_PATTERN_ESCALATION_MINIMUM=low
NLP_THRESHOLD_PATTERN_OVERRIDE_THRESHOLD=0.8
NLP_THRESHOLD_COMMUNITY_PATTERN_BOOST=1.1

# ============== GAP DETECTION CONFIGURATION ===============================
# Model disagreement and gap detection settings  
NLP_THRESHOLD_GAP_DETECTION=0.25
NLP_THRESHOLD_GAP_DISAGREEMENT=0.30
NLP_THRESHOLD_GAP_AUTO_ESCALATION=true
NLP_THRESHOLD_GAP_MAX_CONFIDENCE_SPREAD=0.4
NLP_THRESHOLD_GAP_MIN_AGREEMENT_SCORE=0.6

# ============== VALIDATION CONFIGURATION ==================================
# Threshold validation and fail-fast behavior
NLP_THRESHOLD_VALIDATION_STRICT=true
NLP_THRESHOLD_VALIDATION_FAIL_ON_INVALID=true
NLP_THRESHOLD_VALIDATION_LOG_WARNINGS=true
NLP_THRESHOLD_VALIDATION_CROSS_MODE_CHECK=true

# =============================================================================
# RATE LIMITING
# =============================================================================
NLP_MAX_REQUESTS_PER_MINUTE=120
NLP_MAX_REQUESTS_PER_HOUR=2000

# =============================================================================
# FEATURE FLAGS
# =============================================================================
NLP_ENABLE_ENSEMBLE_ANALYSIS=true
NLP_ENABLE_PATTERN_INTEGRATION=true
NLP_ENABLE_THRESHOLD_LEARNING=true
NLP_ENABLE_STAFF_REVIEW_LOGIC=true
NLP_ENABLE_SAFETY_CONTROLS=true
NLP_ENABLE_MODE_SWITCHING=true