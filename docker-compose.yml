services:
  ash-nlp:
    # For production: pull from GitHub Container Registry
    image: ghcr.io/the-alphabet-cartel/ash-nlp:latest

    # For local development: build locally
#    build:
#      context: .
#      dockerfile: Dockerfile

    container_name: ash-nlp
    restart: unless-stopped
    networks:
      - ash-network
    ports:
      - 8881:8881
    environment:
      - PYTHONUNBUFFERED=1
      - HUGGINGFACE_HUB_TOKEN=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
    # Resource limits for your hardware
    deploy:
      resources:
        limits:
          memory: 8G      # Enough for the ML model
          cpus: '4'       # Half your Ryzen cores
        reservations:
          memory: 2G
          cpus: '1'

networks:
  ash-network:
    driver: bridge